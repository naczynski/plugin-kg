<?php


	/**
	 * Change filename when resource upload
	 */
	class KG_Files_Names_Filter {


		public function __construct() {
			add_filter('sanitize_file_name', array(&$this, 'sanitize_file_name_chars'), 10);
		}

		function sanitize_file_name_chars($filename){
	
			$invalid = array(		
				'Ă'=>'A', 'Ă'=>'A', 'Ă'=>'A', 'Ă'=>'A', 'Ä'=>'A', 'Ä'=>'A', 'ČŚ'=>'A', 'Ă'=>'A', 'áş˘'=>'A', 'Ă'=>'A', 'Ç'=>'A', 'Č'=>'A', 'Č'=>'A', 'Ä'=>'A', 'áş '=>'A', 'á¸'=>'A', 'áşŚ'=>'A', 'áş¤'=>'A', 'áşŞ'=>'A', 'áş¨'=>'A', 'áş°'=>'A', 'áşŽ'=>'A', 'áş´'=>'A', 'áş˛'=>'A', 'Ç '=>'A', 'Ç'=>'A', 'Çş'=>'A', 'áşŹ'=>'A', 'áşś'=>'A',
				'Ă'=>'AE', 'Çź'=>'AE', 'Ç˘'=>'AE', 
				'á¸'=>'B', 'Ć'=>'B', 'á¸'=>'B', 'á¸'=>'B', 'Ć'=>'B', 'Ć'=>'B', 'Ă'=>'B',
				'Ä'=>'C', 'Ä'=>'C', 'Ä'=>'C', 'Ć'=>'C', 'Ă'=>'C', 'á¸'=>'C',
				'á¸'=>'D', 'Ć'=>'D', 'á¸'=>'D', 'á¸'=>'D', 'á¸'=>'D', 'á¸'=>'D', 'Ä'=>'D',
				'Ä'=>'Dj', 'Ć'=>'Dj',
				'Ă'=>'E', 'Ă'=>'E', 'Ă'=>'E', 'áşź'=>'E', 'Ä'=>'E', 'Ä'=>'E', 'Ä'=>'E', 'Ă'=>'E', 'áşş'=>'E', 'Ä'=>'E', 'Č'=>'E', 'Č'=>'E', 'áş¸'=>'E', 'Č¨'=>'E', 'Ä'=>'E', 'á¸'=>'E', 'á¸'=>'E', 'áť'=>'E', 'áşž'=>'E', 'áť'=>'E', 'áť'=>'E', 'á¸'=>'E', 'á¸'=>'E', 'áť'=>'E', 'á¸'=>'E', 'Ć'=>'E', 'Ć'=>'E', 
				'á¸'=>'F', 'Ć'=>'F', 
				'Ç´'=>'G', 'Ä'=>'G', 'á¸ '=>'G', 'Ä'=>'G', 'Ä '=>'G', 'ÇŚ'=>'G', 'Ć'=>'G', 'Ä˘'=>'G', 'Ç¤'=>'G', 
				'Ä¤'=>'H', 'á¸Ś'=>'H', 'Č'=>'H', 'Çś'=>'H', 'á¸¤'=>'H', 'á¸¨'=>'H', 'á¸Ş'=>'H', 'ÄŚ'=>'H',
				'Ă'=>'I', 'Ă'=>'I', 'Ă'=>'I', 'Ä¨'=>'I', 'ÄŞ'=>'I', 'ÄŹ'=>'I', 'Ä°'=>'I', 'Ă'=>'I', 'áť'=>'I', 'Ç'=>'I', 'áť'=>'I', 'ÄŽ'=>'I', 'Č'=>'I', 'Č'=>'I', 'á¸Ź'=>'I', 'Ć'=>'I', 'á¸Ž'=>'I', 
				'Ä˛'=>'IJ',
				'Ä´'=>'J',
				'á¸°'=>'K', 'Ç¨'=>'K', 'á¸´'=>'K', 'Ć'=>'K', 'á¸˛'=>'K', 'Äś'=>'K', 'Äš'=>'L', 'á¸ş'=>'L', 'á¸ś'=>'L', 'Äť'=>'L', 'á¸ź'=>'L', 'Ä˝'=>'L', 'Äż'=>'L', 'Ĺ'=>'L', 'á¸¸'=>'L', 
				'á¸ž'=>'M', 'áš'=>'M', 'áš'=>'M', 'Ć'=>'M', 'Ă'=>'N', 'Ç¸'=>'N', 'Ĺ'=>'N', 'Ă'=>'N', 'áš'=>'N', 'Ĺ'=>'N', 'Ĺ'=>'N', 'Ć'=>'N', 'áš'=>'N', 'Ĺ'=>'N', 'áš'=>'N', 'áš'=>'N', 'Č '=>'N',
				'Ă'=>'O', 'Ă'=>'O', 'Ă'=>'O', 'Ă'=>'O', 'Ĺ'=>'O', 'Ĺ'=>'O', 'ČŽ'=>'O', 'Ă'=>'O', 'áť'=>'O', 'Ĺ'=>'O', 'Ç'=>'O', 'Č'=>'O', 'Č'=>'O', 'Ć '=>'O', 'ÇŞ'=>'O', 'áť'=>'O', 'Ć'=>'O', 'Ă'=>'O', 'áť'=>'O', 'áť'=>'O', 'áť'=>'O', 'áť'=>'O', 'Č°'=>'O', 'ČŞ'=>'O', 'ČŹ'=>'O', 'áš'=>'O', 'áš'=>'O', 'áš'=>'O', 'áť'=>'O', 'áť'=>'O', 'áť '=>'O', 'áť'=>'O', 'áť˘'=>'O', 'ÇŹ'=>'O', 'áť'=>'O', 'Çž'=>'O', 'Ć'=>'O', 'Ĺ'=>'OE',
				'áš'=>'P', 'áš'=>'P', 'Ć¤'=>'P',
				'Ĺ'=>'R', 'áš'=>'R', 'Ĺ'=>'R',	'Č'=>'R', 'Č'=>'R', 'áš'=>'R', 'Ĺ'=>'R', 'áš'=>'R', 'áš'=>'R', 'ĆŚ'=>'R',
				'Ĺ'=>'S', 'Ĺ'=>'S', 'áš '=>'S', 'Ĺ '=>'S', 'áš˘'=>'S', 'Č'=>'S', 'Ĺ'=>'S', 'áš¤'=>'S', 'ášŚ'=>'S', 'áš¨'=>'S',
				'ášŞ'=>'T', 'Ĺ¤'=>'T', 'ĆŹ'=>'T', 'ĆŽ'=>'T', 'ášŹ'=>'T', 'Č'=>'T', 'Ĺ˘'=>'T', 'áš°'=>'T', 'ášŽ'=>'T', 'ĹŚ'=>'T', 
				'Ă'=>'U', 'Ă'=>'U', 'Ă'=>'U', 'Ĺ¨'=>'U', 'ĹŞ'=>'U', 'ĹŹ'=>'U', 'Ă'=>'U', 'áťŚ'=>'U', 'ĹŽ'=>'U', 'Ĺ°'=>'U', 'Ç'=>'U', 'Č'=>'U', 'Č'=>'U', 'ĆŻ'=>'U', 'áť¤'=>'U', 'áš˛'=>'U', 'Ĺ˛'=>'U', 'ášś'=>'U', 'áš´'=>'U', 	'áš¸'=>'U', 'ášş'=>'U', 'Ç'=>'U', 'Ç'=>'U', 'Ç'=>'U', 'Ç'=>'U', 'áťŞ'=>'U', 	'áť¨'=>'U', 'áťŽ'=>'U', 'áťŹ'=>'U', 'áť°'=>'U',
				'ášź'=>'V', 'ášž'=>'V', 'Ć˛'=>'V',
				'áş'=>'W', 'áş'=>'W', 'Ĺ´'=>'W', 'áş'=>'W', 'áş'=>'W', 'áş'=>'W',
				'áş'=>'X', 'áş'=>'X',
				'áť˛'=>'Y', 'Ă'=>'Y', 'Ĺś'=>'Y', 'áť¸'=>'Y', 'Č˛'=>'Y', 'áş'=>'Y', 'Ĺ¸'=>'Y', 'áťś'=>'Y', 'Ćł'=>'Y', 'áť´'=>'Y',
				'Ĺš'=>'Z', 'áş'=>'Z', 'Ĺť'=>'Z', 'Ĺ˝'=>'Z', 'Č¤'=>'Z', 'áş'=>'Z', 'áş'=>'Z', 'Ćľ'=>'Z',
				'Ă '=>'a', 'ĂĄ'=>'a', 'Ă˘'=>'a', 'ĂŁ'=>'a', 'Ä'=>'a', 'Ä'=>'a', 'Č§'=>'a', 'Ă¤'=>'a', 'áşŁ'=>'a', 'ĂĽ'=>'a', 'Ç'=>'a', 'Č'=>'a', 'Ä'=>'a', 'áşĄ'=>'a', 'á¸'=>'a', 'áş'=>'a', 'áş§'=>'a', 'áşĽ'=>'a', 'áşŤ'=>'a', 'áşŠ'=>'a', 'áşą'=>'a', 'áşŻ'=>'a', 'áşľ'=>'a', 'áşł'=>'a', 'ÇĄ'=>'a', 'Ç'=>'a', 'Çť'=>'a', 'áş­'=>'a', 'áşˇ'=>'a', 
				'ĂŚ'=>'ae', 'Ç˝'=>'ae', 'ÇŁ'=>'ae', 
				'á¸'=>'b', 'É'=>'b', 'á¸'=>'b', 'á¸'=>'b', 'Ć'=>'b', 'Ć'=>'b', 'Ć'=>'b', 'Ăž'=>'b',
				'Ä'=>'c', 'Ä'=>'c', 'Ä'=>'c', 'Ä'=>'c', 'Ć'=>'c', 'Ă§'=>'c', 'á¸'=>'c',
				'á¸'=>'d', 'É'=>'d', 'á¸'=>'d', 'á¸'=>'d', 'á¸'=>'d', 'á¸'=>'d', 'Ä'=>'d', 'Ä'=>'d', 'Ć'=>'d', 'ČĄ'=>'d',
				'Ä'=>'dj',
				'Ă¨'=>'e', 'ĂŠ'=>'e', 'ĂŞ'=>'e', 'áş˝'=>'e', 'Ä'=>'e', 'Ä'=>'e', 'Ä'=>'e', 'ĂŤ'=>'e', 'áşť'=>'e', 'Ä'=>'e', 'Č'=>'e', 'Č'=>'e', 'áşš'=>'e', 'ČŠ'=>'e', 'Ä'=>'e', 'á¸'=>'e', 'á¸'=>'e', 'áť'=>'e', 'áşż'=>'e', 			'áť'=>'e', 'áť'=>'e', 'á¸'=>'e', 'á¸'=>'e', 'áť'=>'e', 'á¸'=>'e', 'Ç'=>'e', 'É'=>'e', 
				'á¸'=>'f', 'Ć'=>'f', 
				'Çľ'=>'g', 'Ä'=>'g', 'á¸Ą'=>'g', 'Ä'=>'g', 'ÄĄ'=>'g', 'Ç§'=>'g', 'É '=>'g', 'ÄŁ'=>'g', 'ÇĽ'=>'g',
				'ÄĽ'=>'h', 'á¸Ł'=>'h', 'á¸§'=>'h', 'Č'=>'h', 'Ć'=>'h', 'á¸Ľ'=>'h', 'á¸Š'=>'h', 'á¸Ť'=>'h', 'áş'=>'h', 'Ä§'=>'h',
				'ĂŹ'=>'i', 'Ă­'=>'i', 'ĂŽ'=>'i', 'ÄŠ'=>'i', 'ÄŤ'=>'i', 'Ä­'=>'i', 'Äą'=>'i', 'ĂŻ'=>'i', 'áť'=>'i', 'Ç'=>'i', 'áť'=>'i', 'ÄŻ'=>'i', 'Č'=>'i', 'Č'=>'i', 'á¸­'=>'i',  'É¨'=>'i', 'á¸Ż'=>'i',
				'Äł'=>'ij',
				'Äľ'=>'j', 'Ç°'=>'j', 
				'á¸ą'=>'k', 'ÇŠ'=>'k', 'á¸ľ'=>'k', 'Ć'=>'k', 'á¸ł'=>'k', 'Äˇ'=>'k',
				'Äş'=>'l', 'á¸ť'=>'l', 'á¸ˇ'=>'l', 'Äź'=>'l', 'á¸˝'=>'l', 'Äž'=>'l', 'Ĺ'=>'l', 'Ĺ'=>'l', 'Ć'=>'l', 'á¸š'=>'l', 'Č´'=>'l', 
				'á¸ż'=>'m', 'áš'=>'m', 'áš'=>'m', 'ÉŻ'=>'m', 
				'Çš'=>'n', 'Ĺ'=>'n', 'Ăą'=>'n', 'áš'=>'n', 'Ĺ'=>'n', 'Ĺ'=>'n', 'É˛'=>'n', 'áš'=>'n', 'Ĺ'=>'n', 'áš'=>'n', 'áš'=>'n', 'Ĺ'=>'n', 'Ć'=>'n', 'Čľ'=>'n',
				'Ă˛'=>'o', 'Ăł'=>'o', 'Ă´'=>'o', 'Ăľ'=>'o', 'Ĺ'=>'o', 'Ĺ'=>'o', 'ČŻ'=>'o', 'Ăś'=>'o', 'áť'=>'o', 'Ĺ'=>'o', 'Ç'=>'o', 'Č'=>'o', 'Č'=>'o', 'ĆĄ'=>'o', 'ÇŤ'=>'o', 'áť'=>'o', 'Éľ'=>'o', 'Ă¸'=>'o', 'áť'=>'o', 'áť'=>'o', 'áť'=>'o', 'áť'=>'o', 'Čą'=>'o', 'ČŤ'=>'o', 'Č­'=>'o', 'áš'=>'o', 'áš'=>'o', 'áš'=>'o', 'áš'=>'o', 'áť'=>'o', 'áť'=>'o', 'áťĄ'=>'o', 'áť'=>'o', 'áťŁ'=>'o', 'Ç­'=>'o', 'áť'=>'o', 'Çż'=>'o', 'É'=>'o', 
				'Ĺ'=>'oe',
				'áš'=>'p', 'áš'=>'p', 'ĆĽ'=>'p', 
				'Ĺ'=>'r', 'áš'=>'r', 'Ĺ'=>'r', 'Č'=>'r', 'Č'=>'r', 'áš'=>'r', 'Ĺ'=>'r', 'áš'=>'r', 'áš'=>'r',
				'Ĺ'=>'s', 'Ĺ'=>'s', 'ášĄ'=>'s', 'ĹĄ'=>'s', 'ášŁ'=>'s', 'Č'=>'s', 'Ĺ'=>'s', 'ášĽ'=>'s', 'áš§'=>'s', 'ášŠ'=>'s', 'Ĺż'=>'s', 'áş'=>'s',
				'Ă'=>'Ss',			
				'ášŤ'=>'t', 'áş'=>'t', 'ĹĽ'=>'t', 'Ć­'=>'t', 'Ę'=>'t', 'ĆŤ'=>'t', 'áš­'=>'t', 'Č'=>'t', 'ĹŁ'=>'t', 'ášą'=>'t', 'ášŻ'=>'t', 'Ĺ§'=>'t', 'Čś'=>'t',
				'Ăš'=>'u', 'Ăş'=>'u', 'Ăť'=>'u', 'ĹŠ'=>'u', 'ĹŤ'=>'u', 'Ĺ­'=>'u', 'Ăź'=>'u', 'áť§'=>'u', 'ĹŻ'=>'u', 'Ĺą'=>'u', 'Ç'=>'u', 'Č'=>'u', 'Č'=>'u', 'Ć°'=>'u', 'áťĽ'=>'u', 'ášł'=>'u', 'Ĺł'=>'u', 'ášˇ'=>'u', 'ášľ'=>'u', 'ášš'=>'u', 'ášť'=>'u', 'Ç'=>'u', 'Ç'=>'u', 'Ç'=>'u', 'Ç'=>'u', 'áťŤ'=>'u', 'áťŠ'=>'u', 'áťŻ'=>'u', 'áť­'=>'u', 'áťą'=>'u', 
				'áš˝'=>'v', 'ášż'=>'v', 
				'áş'=>'w', 'áş'=>'w', 'Ĺľ'=>'w', 'áş'=>'w', 'áş'=>'w', 'áş'=>'w', 'áş'=>'w',
				'áş'=>'x', 'áş'=>'x', 
				'Ă˝'=>'y', 'Ă˝'=>'y', 'áťł'=>'y', 'Ă˝'=>'y', 'Ĺˇ'=>'y', 'Čł'=>'y', 'áş'=>'y', 'Ăż'=>'y', 'Ăż'=>'y', 'áťˇ'=>'y', 'áş'=>'y', 'Ć´'=>'y', 'áťľ'=>'y',
				'Ĺş'=>'z', 'áş'=>'z', 'Ĺź'=>'z', 'Ĺž'=>'z', 'ČĽ'=>'z', 'áş'=>'z', 'áş'=>'z', 'Ćś'=>'z',
				'â'=>'No',
				'Âş'=>'o',
				'ÂŞ'=>'a',
				'âŹ'=>'E',
				'ÂŠ'=>'C',
				'â'=>'P',
				'â˘'=>'tm',
				'â '=>'sm'
			);

			$sanitized_filename = str_replace(array_keys($invalid), array_values($invalid), $filename);
			$sanitized_filename = remove_accents($sanitized_filename);
			$sanitized_filename = preg_replace('/[^a-zA-Z0-9-_\.]/', '', strtolower($sanitized_filename));

			return $sanitized_filename;
		}

	}